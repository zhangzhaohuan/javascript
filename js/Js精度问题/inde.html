<!DOCTYPE html>
<html>
  <head>
    <title>0.1 + 0.2 ≠ 0.3？以前我也不信_二进制</title>



   
    <!-- 在这里插入css -->

    <link
      rel="preload"
      href="https://g1.itc.cn/msfe-pcarti-prod/300000000000/assets/css/default.main.main_article-b4cfc1.css"
      as="style"
    />
    <link
      href="https://g1.itc.cn/msfe-pcarti-prod/300000000000/assets/css/default.main.main_article-b4cfc1.css"
      rel="stylesheet"
    />

    <link
      rel="preload"
      href="https://g1.itc.cn/msfe-pcarti-prod/300000000000/assets/css/main_article-16da63.css"
      as="style"
    />
    <link
      href="https://g1.itc.cn/msfe-pcarti-prod/300000000000/assets/css/main_article-16da63.css"
      rel="stylesheet"
    />
  </head>
  <body
    class="article-page"
    data-region="154"
    data-spm="content"
    data-newsid="465586308"
  >
    <div class="wrapper-box">
      <header id="main-header" class="error-head">
        <div class="head-container">
          <div class="head-nav" data-spm="nav">
            <ul>
              <li class="index">
                <a
                  data-clev="10220248"
                  class="clearfix"
                  target="_blank"
                  href="http://www.sohu.com"
                >
                  <span class="sohu-logo"></span>
                </a>
              </li>
              <li class="nav-item">
                <a
                  target="_blank"
                  data-clev="10220249"
                  href="http://news.sohu.com/"
                  >新闻</a
                >
              </li>
              <li class="nav-item">
                <a
                  target="_blank"
                  data-clev="10220250"
                  href="http://sports.sohu.com/"
                  >体育</a
                >
              </li>
              <li class="nav-item">
                <a
                  target="_blank"
                  data-clev="10220251"
                  href="http://auto.sohu.com/"
                  >汽车</a
                >
              </li>
              <li class="nav-item">
                <a
                  target="_blank"
                  data-clev="10220252"
                  href="http://www.focus.cn/"
                  >房产</a
                >
              </li>
              <li class="nav-item">
                <a
                  target="_blank"
                  data-clev="10220253"
                  href="http://travel.sohu.com/"
                  >旅游</a
                >
              </li>
              <li class="nav-item">
                <a
                  target="_blank"
                  data-clev="10220254"
                  href="http://learning.sohu.com/"
                  >教育</a
                >
              </li>
              <li class="nav-item">
                <a
                  target="_blank"
                  data-clev="10220255"
                  href="http://fashion.sohu.com/"
                  >时尚</a
                >
              </li>
              <li class="nav-item">
                <a
                  target="_blank"
                  data-clev="10220256"
                  href="http://it.sohu.com/"
                  >科技</a
                >
              </li>
              <li class="nav-item">
                <a
                  target="_blank"
                  data-clev="10220257"
                  href="http://business.sohu.com/"
                  >财经</a
                >
              </li>
              <li class="nav-item">
                <a
                  target="_blank"
                  data-clev="10220258"
                  href="http://yule.sohu.com/"
                  >娱乐</a
                >
              </li>
              <li class="nav-item more-nav">
                <a class="more-tag" href="javascript:void(0)"
                  >更多<em class="cor"></em
                ></a>
                <div class="more-nav-box">
                  <a href="http://baobao.sohu.com/">母婴</a>
                  <a href="https://healthnews.sohu.com/">健康</a>
                  <a href="http://history.sohu.com/">历史</a>
                  <a href="http://mil.sohu.com/">军事</a>
                  <a href="http://chihe.sohu.com/">美食</a>
                  <a href="http://cul.sohu.com/">文化</a>
                  <a href="http://astro.sohu.com/">星座</a>
                  <a href="https://www.sohu.com/xchannel/TURBd01EQXhPVGt5"
                    >专题</a
                  >
                  <a href="http://game.sohu.com/">游戏</a>
                  <a href="http://fun.sohu.com/">搞笑</a>
                  <a href="http://acg.sohu.com/">动漫</a>
                  <a href="http://pets.sohu.com/">宠物</a>
                </div>
              </li>
            </ul>
          </div>
          <div class="right head-rihgt">
            <div class="no-barrier">
              <a href="javascript:void(0)" id="pc-channel-wza-entry">无障碍</a>
              <span class="divider"></span>
              <a href="javascript:void(0)" id="pc-channel-ghb-entry">关怀版</a>
            </div>
            <div id="head-login"></div>
          </div>
        </div>
      </header>
      <div class="location-without-nav"></div>
      <div class="area clearfix" id="article-container">
        <div class="column left">
          <div class="user-info" id="user-info" data-spm="author">
            <div class="user-pic">
              <!-- fromWhere为10是马甲号作者不可点击进入个人页面 -->
              <a
                href="https://mp.sohu.com/profile?xpt=cGhwZGV2c0Bzb2h1LmNvbQ==&_f=index_pagemp_1"
                target="_blank"
              >
                <img
                  data-src="http://29e5534ea20a8.cdn.sohucs.com/c_zoom,w_100/blog/avatar/11111.gif"
                  alt=""
                />
              </a>
            </div>
          </div>
        </div>
        <div class="left main">
          <div data-spm="content">
            <div class="text">
              <div class="text-title">
                <h1>
                  0.1 + 0.2 ≠ 0.3？以前我也不信
                  <span class="article-tag"> </span>
                </h1>
                <div class="article-info">
                  <span class="time" id="news-time" data-val="1620619500000"
                    >2021-05-10 12:05</span
                  >
                  <span data-role="original-link">
                    来源:
                    <a href="//www.sohu.com" target="_blank">php开发者.</a>
                  </span>
                </div>
              </div>
              <article class="article" id="mp-editor">
                <!-- 政务处理 -->
                <p data-role="original-title" style="display: none">
                  原标题：0.1 + 0.2 ≠ 0.3？以前我也不信
                </p>
                <p>
                  <span style="font-size: 16px"></span
                  ><span style="font-size: 16px"
                    >之前在知乎回答过这么个问题：</span
                  ><span style="font-size: 16px">「</span
                  ><strong>有哪些事实没有一定计算机知识的人不会相信？</strong
                  ><span style="font-size: 16px">」，收获了不少赞。</span>
                </p>
                <p>
                  <img
                    data-src="ZEdxni/u2gmtwZ8CLj8V0cmJ5ULT+qz1crB9Zo+mUNN5UtXeVwL3Bw+oxLcQZx5qtzG3eP9EabOJErG4bN/vkobMPTHeco2iUTBQDklGBzo="
                  />
                </p>
                <p>
                  我举的例子是：0.1 + 0.2 计算的结果，大家肯定知道是等于 0.3
                  ，但是
                  <strong>在计算机中 0.1 + 0.2 并不是等于 0.3</strong>，而是：
                </p>
                <p>
                  为什么会出现这个结果呢？这就需要一定计算机知识的人才会知道。
                </p>
                <p>
                  今天，我们来一步一步思考下面这些问题，然后最后再来说说为什么计算机里
                  0.1 + 0.2 != 0.3。
                </p>
                <ul>
                  <li><p>为什么负数要用补码表示？</p></li>
                  <li><p>十进制小数怎么转成二进制？</p></li>
                  <li><p>计算机是怎么存小数的？</p></li>
                  <li><p>0.1 + 0.2 == 0.3 吗？</p></li>
                </ul>
                <span></span>
                <span style="font-size: 20px"
                  >别看这些问题都看似简单，但是其实还是有点东西。</span
                >
                <span></span>
                <span style="font-size: 16px">为什么负数要用补码表示？</span>
                <span></span>
                <p>
                  十进制转换二进制的方法相信大家都熟能生巧了，如果你说你还不知道，我觉得你还是太谦虚，可能你只是忘记了，即使你真的忘记了，不怕，贴心的小林在和你一起回忆一下。
                </p>
                <p>
                  十进制数转二进制采用的是
                  <strong>除 2 取余法</strong>，比如数字 8
                  转二进制的过程如下图：
                </p>
                <p>
                  <img
                    data-src="69sN8Ip3srJQEvztaqmSmcmJ5ULT+qz1crB9Zo+mUNNeC40Hw3+gFU1ogx9BbZtzwPljvmvI5e/iw66QX5GKHW2oprqfvf07ugRjvANXAdY="
                  />
                </p>
                <p>
                  接着，我们看看「整数类型」的数字在计算机的存储方式，这其实很简单，也很直观，就是将十进制的数字转换成二进制即可。
                </p>
                <p>
                  我们以 int 类型的数字作为例子，int 类型是 32 位的，其中
                  <strong>最高位是作为「符号标志位」</strong>，正数的符号位是 0
                  ，负数的符号位是 1 ，
                  <strong>剩余的 31 位则表示二进制数据</strong>。
                </p>
                <p>那么，对于 int 类型的数字 1 的二进制数表示如下：</p>
                <p>
                  <img
                    data-src="ltlBByDSz8LS2xDpve58U8mJ5ULT+qz1crB9Zo+mUNNOjX7dPRAqsTvzd0XRb+EwFFmPgUB7dsLjjQ4OandeQaXkvR17ysgcErzP1cyjFqQ="
                  />
                </p>
                <p>
                  而负数就比较特殊了点，负数在计算机中是以「补码」表示的，
                  <strong>所谓的补码就是把正数的二进制全部取反再加 1</strong
                  >，比如 -1 的二进制是把数字 1 的二进制取反后再加 1，如下图：
                </p>
                <p>
                  <img
                    data-src="tFrMB+7VwiBW2HbD2hOnH8mJ5ULT+qz1crB9Zo+mUNNo5zRhppG9yjxO5Wvlchg8zNdAFI5XgnSy8vKLK3vYO6ZJITBQtd5Mwi5pMOYWNRg="
                  />
                </p>
                <p>
                  不知道你有没有想过，为什么计算机要用补码的方式来表示负数？在回答这个问题前，我们假设不用补码的方式来表示负数，而只是把最高位的符号标志位变为
                  1 表示负数，如下图过程：
                </p>
                <p>
                  <img
                    data-src="8MY9RGaCWaBsd6kkgG/pScmJ5ULT+qz1crB9Zo+mUNNKtCOft0Ii0ES5XSHOd3d0Rarsw1LAYLDE1YG8crxzVz2uGA7rOu0l0x0hheGNdXE="
                  />
                </p>
                <p>
                  如果采用这种方式来表示负数的二进制的话，试想一下 -2 + 1
                  的运算过程，如下图：
                </p>
                <p>
                  <img
                    data-src="5LtMAMmc+K81jpOuQ2EB4smJ5ULT+qz1crB9Zo+mUNMJ7yE61rnW607xV+Dg7OLVRQVg/3CpYKQBesUVvWAp/2t+HCno04YBUKqAR2hK354="
                  />
                </p>
                <p>
                  按道理， -2 + 1 = -1 ，但是上面的运算过程中得到结果却是 -3
                  ，所可以发现，这种负数的表示方式是不能用常规的加法来计算了，就需要特殊处理，要先判断数字是否为负数，如果是负数就要把加法操作变成减法操作才可以得到正确对结果。
                </p>
                <p>
                  到这里，我们就可以回答前面提到的「负数为什么要用补码方式来表示」的问题了。
                </p>
                <p>
                  如果负数不是使用补码的方式表示，则在做基本对加减法运算的时候，
                  <strong
                    >还需要多一步操作来判断是否为负数，如果为负数，还得把加法反转成减法，或者把减法反转成加法</strong
                  >，这就非常不好了，毕竟加减法运算在计算机里是很常使用的，所以为了性能考虑，应该要尽量简化这个运算过程。
                </p>
                <p>
                  <strong
                    >而用了补码的表示方式，对于负数的加减法操作，实际上是和正数加减法操作一样的</strong
                  >。你可以看到下图，用补码表示的负数在运算 -2 + 1
                  过程的时候，其结果是正确的：
                </p>
                <p>
                  <img
                    data-src="69sN8Ip3srJQEvztaqmSmcmJ5ULT+qz1crB9Zo+mUNOc+Bb+Dx616OO0HJrW9LbNClmArRlexrJ0tD5DTI3Q0AyPvIUWHJw0pW3JhSJ88Nk="
                  />
                </p>
                <p>
                  <span></span
                  ><span style="font-size: 16px">十进制小数与二进制的转换</span
                  ><span></span>
                </p>
                <p>
                  好了，整数十进制转二进制我们知道了，接下来看看小数是怎么转二进制的，小数部分的转换不同于整数部分，它采用的是
                  <strong>乘 2 取整法</strong>，将十进制中的小数部分乘以 2
                  作为二进制的一位，然后继续取小数部分乘以 2
                  作为下一位，直到不存在小数为止。
                </p>
                <p>话不多说，我们就以 8.625 转二进制作为例子，直接上图：</p>
                <p>
                  <img
                    data-src="ltlBByDSz8LS2xDpve58U8mJ5ULT+qz1crB9Zo+mUNMtbY0/g7meUTPdMohHBrQc4Ng+TeZQJTH1MtFZAW2wVIoAjsBFNoTYrhyjtSt3riA="
                  />
                </p>
                <p>
                  最后把「整数部分 + 小数部分」结合在一起后，其结果就是 1000.101
                  。
                </p>
                <p>
                  但是，并不是所有小数都可以用二进制表示，前面提到的 0.625
                  小数是一个特例，刚好通过乘 2 取整法的方式完整的转换成二进制。
                </p>
                <p>如果我们用相同的方式，来把 0.1 转换成二进制，过程如下：</p>
                <p>
                  <img
                    data-src="b64Pq9zySn93kgty0uAqZ8mJ5ULT+qz1crB9Zo+mUNNZwc3q2RvHf/I7vTKzK8GrDp3z93j6HnecKm8eM7xGnDdSaC2E1dcVnTuC/TxVQ0A="
                  />
                </p>
                <p>可以发现， 0.1 的二进制表示是无限循环的。</p>
                <p>
                  <strong
                    >由于计算机的资源是有限的，所以是没办法用二进制精确的表示
                    0.1，只能用「近似值」来表示，就是在有限的精度情况下，最大化接近
                    0.1 的二进制数，于是就会造成精度缺失的情况</strong
                  >。
                </p>
                <p>
                  对于二进制小数转十进制时，需要注意一点，小数点后面的指数幂是
                  <strong>负数</strong>。
                </p>
                <p>
                  比如，二进制 0.1 转成十进制就是 2^(-1) ，也就是十进制 0.5
                  ，二进制 0.01 转成十进制就是 2^-2 ，也就是十进制 0.25
                  ，以此类推。
                </p>
                <p>举个例子，二进制 1010.101 转十进制的过程，如下图：</p>
                <p>
                  <img
                    data-src="pAptA0m3a361MlzXFaINeMmJ5ULT+qz1crB9Zo+mUNP50s/oZdrCU4xnt1KWSK8mqIJADV56ktGuFLax2fm8nmO4g/FcffTvow7eE4O6d6g="
                  />
                </p>
                <p>
                  <span></span
                  ><span style="font-size: 16px">计算机是怎么存小数的？</span
                  ><span></span>
                </p>
                <p>
                  1000.101
                  这种二进制小数是「定点数」形式，代表着小数点是定死的，不能移动，如果你移动了它的小数点，这个数就变了，
                  就不再是它原来的值了。
                </p>
                <p>
                  然而，计算机并不是这样存储的小数的，计算机存储小数的采用的是
                  <strong>浮点数</strong
                  >，名字里的「浮点」表示小数点是可以浮动的。
                </p>
                <p>
                  比如 1000.101 这个二进制数，可以表示成 1.000101 x 2^3
                  ，类似于数学上的科学记数法。
                </p>
                <p>既然提到了科学计数法，我再帮大家复习一下。</p>
                <p>
                  该方法在小数点左边只有一个数字，而且把这种整数部分没有前导 0
                  的数字称为 <strong>规格化</strong>，比如 1.0 x 10^(-9)
                  是规格化的科学记数法，而 0.1 x 10^(-9) 和 10.0 x 10^(-9)
                  就不是了。
                </p>
                <p>
                  因此，如果二进制要用到科学记数法，同时要规范化，那么不仅要保证基数为
                  2，还要保证小数点左侧只有 1 位，而且必须为 1。
                </p>
                <p>
                  所以通常将 1000.101 这种二进制数，规格化表示成 1.000101 x 2^3
                  ，其中，最为关键的是 000101 和 3
                  这两个东西，它就可以包含了这个二进制小数的所有信息：
                </p>
                <ul>
                  <li>
                    <p>
                      000101 称为 <strong>尾数</strong>，即小数点后面的数字；
                    </p>
                  </li>
                  <li>
                    <p>
                      3 称为 <strong>指数</strong>，指定了小数点在数据中的位置；
                    </p>
                  </li>
                </ul>
                <p>
                  现在绝大多数计算机使用的浮点数，一般采用的是 IEEE
                  制定的国际标准，这种标准形式如下图：
                </p>
                <p>
                  <img
                    data-src="b64Pq9zySn93kgty0uAqZ8mJ5ULT+qz1crB9Zo+mUNPmo8cYkKuLLmEcU9eM0hlFCjZ087zY8TVGsGTt1sIrxpfmZzeuJA7P9dmtkK3HaqY="
                  />
                </p>
                <p>这三个重要部分的意义如下：</p>
                <ul>
                  <li>
                    <p>
                      符号位：表示数字是正数还是负数，为 0 表示正数，为 1
                      表示负数；
                    </p>
                  </li>
                  <li>
                    <p>
                      指数位：指定了小数点在数据中的位置，指数可以是负数，也可以是正数，
                      <strong>指数位的长度越长则数值的表达范围就越大</strong>；
                    </p>
                  </li>
                  <li>
                    <p>
                      尾数位：小数点右侧的数字，也就是小数部分，比如二进制
                      1.0011 x 2^(-2)，尾数部分就是 0011，而且
                      <strong>尾数的长度决定了这个数的精度</strong
                      >，因此如果要表示精度更高的小数，则就要提高尾数位的长度；
                    </p>
                  </li>
                </ul>
                <p>
                  用 32 位来表示的浮点数，则称为
                  <strong>单精度浮点数</strong>，也就是我们编程语言中的 float
                  变量，而用 64 位来表示的浮点数，称为
                  <strong>双精度浮点数</strong>，也就是 double
                  变量，它们的结构如下：
                </p>
                <p>
                  <img
                    data-src="ZEdxni/u2gmtwZ8CLj8V0cmJ5ULT+qz1crB9Zo+mUNOVRbDcHXHoQ0YnBm0VjnJYfLUIBZ5RHzhEivBHCT5U4o4ljGNou4ld++F5yyeI26Y="
                  />
                </p>
                <p>可以看到：</p>
                <ul>
                  <li>
                    <p>
                      double 的尾数部分是 52 位，float 的尾数部分是 23
                      位，由于同时都带有一个固定隐含位（这个后面会说），所以
                      double 有 53 个二进制有效位，float 有 24
                      个二进制有效位，所以所以它们的精度在十进制中分别是
                      log10(2^53) 约等于 15.95 和 log10(2^24) 约等于 7.22
                      位，因此 double 的有效数字是 15~16 位，float 的有效数字是
                      7~8 位，这些是有效位是包含整数部分和小数部分；
                    </p>
                  </li>
                  <li>
                    <p>
                      double 的指数部分是 11 位，而 float 的指数位是 8
                      位，意味着 double 相比 float 能表示更大的数值范围；
                    </p>
                  </li>
                </ul>
                <p>那二进制小数，是如何转换成二进制浮点数的呢？</p>
                <p>
                  我们就以 10.625 作为例子，看看这个数字在 float
                  里是如何存储的。
                </p>
                <p>
                  <img
                    data-src="pAptA0m3a361MlzXFaINeMmJ5ULT+qz1crB9Zo+mUNNI+1YjjIjyqwm9l3vzjeLkp7A2IoqXfn3QGsS3W9pq2gqz6ApemOempzn13J2qgIQ="
                  />
                </p>
                <p>首先，我们计算出 10.625 的二进制小数为 1010.101。</p>
                <p>
                  然后 <strong>把小数点，移动到第一个有效数字后面</strong>，即将
                  1010.101 右移 3 位成 1.010101 ，右移 3 位就代表 +3，左移 3
                  位就是 -3。
                </p>
                <p>在算指数的时候，你可能会有疑问为什么要加上偏移量呢？</p>
                <p>
                  前面也提到，指数可能是正数，也可能是负数，即指数是有符号的整数，而有符号整数的计算是比无符号整数麻烦的，所以为了减少不必要的麻烦，在实际存储指数的时候，需要把指数转换成
                  <strong>无符号整数</strong>。
                </p>
                <p>
                  float 的指数部分是 8 位，IEEE
                  标准规定单精度浮点的指数取值范围是 -126 ~ +127
                  ，于是为了把指数转换成无符号整数，就要加个
                  <strong>偏移量</strong>，比如 float 的指数偏移量是 127
                  ，这样指数就不会出现负数了。
                </p>
                <p>
                  比如，指数如果是 8，则实际存储的指数是 8 + 127（偏移量）=
                  135，即把 135
                  转换为二进制之后再存储，而当我们需要计算实际的十进制数的时候，再把指数减去「偏移量」即可。
                </p>
                <p>
                  细心的朋友肯定发现，移动后的小数点左侧的有效位（即
                  1）消失了，它并没有存储到 float 里。
                </p>
                <p>
                  这是因为 IEEE 标准规定，二进制浮点数的小数点左侧只能有 1
                  位，并且还只能是 1，
                  <strong>既然这一位永远都是 1，那就可以不用存起来了</strong>。
                </p>
                <p>
                  于是就让 23 位尾数只存储小数部分，然后在计算时会
                  <strong
                    >自动把这个 1 加上，这样就可以节约 1
                    位的空间，尾数就能多存一位小数，相应的精度就更高了一点</strong
                  >。
                </p>
                <p>
                  那么，对于我们在从 float
                  的二进制浮点数转换成十进制时，要考虑到这个隐含的
                  1，转换公式如下：
                </p>
                <p>
                  <img
                    data-src="5LtMAMmc+K81jpOuQ2EB4smJ5ULT+qz1crB9Zo+mUNP2Ev99f5j52CojISGW1j0AJNeEBeH8AKLB6voE8bFuCRchu53OTacBXBHhbZFhCyE="
                  />
                </p>
                <p>
                  举个例子，我们把下图这个 float 的数据转换成十进制，过程如下：
                </p>
                <p>
                  <img
                    data-src="evdAdK9nhZS9HVDA4yiKKMmJ5ULT+qz1crB9Zo+mUNNG6Kv66/8iayOa5as9x+C7mzZgEm4oTiGkxm4pvypZQlC1gBzN809M1t0/grHG3wo="
                  />
                </p>
                <p>
                  <span></span
                  ><span style="font-size: 16px">0.1 + 0.2 == 0.3 ?</span
                  ><span></span>
                </p>
                <p>
                  前面提到过，并不是所有小数都可以用「完整」的二进制来表示的，比如十进制
                  0.1
                  在转换成二进制小数的时候，是一串无限循环的二进制数，计算机是无法表达无限循环的二进制数的，毕竟计算机的资源是有限。
                </p>
                <p>
                  因此，计算机只能用「近似值」来表示该二进制，那么意味着计算机存放的小数可能不是一个真实值。
                </p>
                <p>
                  现在基本都是用 IEEE 754
                  规范的「单精度浮点类型」或「双精度浮点类型」来存储小数的，根据精度的不同，近似值也会不同。
                </p>
                <p>那计算机是存储 0.1 是一个怎么样的二进制浮点数呢？</p>
                <p>
                  偷个懒，我就不自己手动算了，可以使用 binaryconvert
                  这个工具，将十进制 0.1 小数转换成 float 浮点数：
                </p>
                <p>
                  <img
                    data-src="ltlBByDSz8LS2xDpve58U8mJ5ULT+qz1crB9Zo+mUNM8NpCzODoE0YiFqsj+0sadmtcvIsPXkUlzqPl5lsBWKyKZLm7hEX2+gnZiNmE63B4="
                  />
                </p>
                <p>接下来，我们看看 0.2 的 float 浮点数：</p>
                <p>
                  <img
                    data-src="8MY9RGaCWaBsd6kkgG/pScmJ5ULT+qz1crB9Zo+mUNM/nu0ISfCcV47CCQpyii89L3FtcXTp9XE2LpbdFUkLQXb7r2M8jlFH4DjbtZJNGfw="
                  />
                </p>
                <p>
                  <img
                    data-src="5LtMAMmc+K81jpOuQ2EB4smJ5ULT+qz1crB9Zo+mUNMz3bMPVu1b8txKFs6E+zN9OsSk+eZe/MjOWgn9ZaH7jF5CJg5tRCwshtijhmzEQSs="
                  />
                </p>
                <p>
                  <img
                    data-src="b64Pq9zySn93kgty0uAqZ8mJ5ULT+qz1crB9Zo+mUNMLdoghwVzkpMFuz5lGH1bc10mwJkBVEyFRd5xkrN1KOfwNRFzKz5puI/PBLKVlWQ0="
                  />
                </p>
                <p>
                  <img
                    data-src="tFrMB+7VwiBW2HbD2hOnH8mJ5ULT+qz1crB9Zo+mUNOEoeCYlUUDVZsO7uC+uZlne0udiUaSsPIGpHxdHWgxfXjkOX72r6wcLs7KUIdb/cI="
                  />
                </p>
                <p>
                  所以，你会看到
                  <strong>在计算机中 0.1 + 0.2 并不等于完整的 0.3</strong>。
                </p>
                <p>
                  这主要是
                  <strong
                    >因为有的小数无法可以用「完整」的二进制来表示，所以计算机里只能采用近似数的方式来保存，那两个近似数相加，得到的必然也是一个近似数</strong
                  >。
                </p>
                <p>我们在 Java 里执行 0.1 + 0.2，你会得到下面这个结果：</p>
                <p>
                  结果和我们前面推到的类似，因为 Java 对于数字都是使用 IEEE 754
                  标准下的双精度浮点类型来存储的。
                </p>
                <p>
                  而我们二进制只能精准表达 2 除尽的数字 1/2, 1/4, 1/8，但是对于
                  0.1(1/10) 和
                  0.2(1/5)，在二进制中都无法精准表示时，需要根据精度舍入。
                </p>
                <p>
                  我们人类熟悉的十进制运算系统，可以精准表达 2 和 5
                  除尽的数字，例如 1/2, 1/4, 1/5(0.2), 1/8, 1/10(0.1)。
                </p>
                <p>
                  当然，十进制也有无法除尽的地方，例如 1/3,
                  1/7，也需要根据精度舍入。
                </p>
                <p>
                  <span></span><span style="font-size: 16px">总结</span
                  ><span></span>
                </p>
                <p>最后，再来回答开头多问题。</p>
                <blockquote>
                  <p>为什么负数要用补码表示？</p>
                </blockquote>
                <p>
                  负数之所以用补码的方式来表示，主要是为了统一和正数的加减法操作一样，毕竟数字的加减法是很常用的一个操作，就不要搞特殊化，尽量以统一的方式来运算。
                </p>
                <blockquote>
                  <p>十进制小数怎么转成二进制？</p>
                </blockquote>
                <p>
                  十进制整数转二进制使用的是「除 2
                  取余法」，十进制小数使用的是「乘 2 取整法」。
                </p>
                <blockquote>
                  <p>计算机是怎么存小数的？</p>
                </blockquote>
                <p>
                  计算机是以浮点数的形式存储小数的，大多数计算机都是 IEEE 754
                  标准定义的浮点数格式，包含三个部分：
                </p>
                <ul>
                  <li>
                    <p>
                      符号位：表示数字是正数还是负数，为 0 表示正数，为 1
                      表示负数；
                    </p>
                  </li>
                  <li>
                    <p>
                      指数位：指定了小数点在数据中的位置，指数可以是负数，也可以是正数，指数位的长度越长则数值的表达范围就越大；
                    </p>
                  </li>
                  <li>
                    <p>
                      尾数位：小数点右侧的数字，也就是小数部分，比如二进制
                      1.0011 x 2^(-2)，尾数部分就是
                      0011，而且尾数的长度决定了这个数的精度，因此如果要表示精度更高的小数，则就要提高尾数位的长度；
                    </p>
                  </li>
                </ul>
                <p>
                  用 32
                  位来表示的浮点数，则称为单精度浮点数，也就是我们编程语言中的
                  float 变量，而用 64 位来表示的浮点数，称为双精度浮点数，也就是
                  double 变量。
                </p>
                <blockquote>
                  <p>0.1 + 0.2 == 0.3 吗？</p>
                </blockquote>
                <p>
                  不是的，0.1 和 0.2
                  这两个数字用二进制表达会是一个一直循环的二进制数，比如 0.1
                  的二进制表示为 0.0 0011 0011 0011… （0011
                  无限循环)，对于计算机而言，0.1
                  无法精确表达，这是浮点数计算造成精度损失的根源。
                </p>
                <p>
                  因此，IEEE 754
                  标准定义的浮点数只能根据精度舍入，然后用「近似值」来表示该二进制，那么意味着计算机存放的小数可能不是一个真实值。
                </p>
                <p>
                  0.1 + 0.2 并不等于完整的
                  0.3，这主要是因为这两个小数无法用「完整」的二进制来表示，只能根据精度舍入，所以计算机里只能采用近似数的方式来保存，那两个近似数相加，得到的必然也是一个近似数。
                </p>
                <p>
                  学到了吗？学到的别忘了点个赞，看看有多少人学到了<a
                    href="//www.sohu.com/?strategyid=00001 "
                    target="_blank"
                    title="点击进入搜狐首页"
                    id="backsohucom"
                    style="white-space: nowrap"
                    ><span class="backword"
                      ><i class="backsohu"></i>返回搜狐，查看更多</span
                    ></a
                  >
                </p>
                <!-- 政务账号添加来源标示处理 -->
                <!-- 政务账号添加来源标示处理 -->
                <p data-role="editor-name">责任编辑：<span></span></p>
              </article>
              <div class="statement">
                平台声明：该文观点仅代表作者本人，搜狐号系信息发布平台，搜狐仅提供信息存储空间服务。
              </div>
              <div class="bottom-relate-wrap clear type-3">
                <div
                  class="article-like"
                  id="article-like"
                  data-like-type="type-3"
                ></div>
                <div class="read-wrap">
                  <span class="read-num"
                    >阅读 (<em data-role="pv" data-val="$articleStat.pv"></em
                    >)</span
                  >
                </div>
                <div id="articleReport">
                  <report />
                </div>
              </div>

              <div id="sohu-play-content"></div>
            </div>
          </div>
          <div data-spm="middle-banner-ad"></div>
          <div class="article-allsee clear" id="articleAllsee">
            <div class="title">
              <span>
                <em class="ln"></em>
                大家都在看
              </span>
            </div>
            <div
              class="allsee-list clear"
              id="allseeList"
              data-spm="fd-link"
            ></div>
          </div>
          <div class="_0u4o3bh76zbp"></div>
          <div
            class="god-article-bottom"
            id="god_bottom_banner"
            data-spm="ad-text-bottom"
            style="display: block"
          ></div>
          <div
            class="user-god clear"
            id="user-post"
            style="display: none"
          ></div>
          <div
            class="comment"
            id="comment_area"
            data-spm="comment"
            data-abdata="1"
          >
            <div id="mp-comment" sid="465586308"></div>
          </div>
          <div id="discuss"></div>

          <div class="groom-read">
            <div class="title">
              <span><em class="ln"></em>推荐阅读</span>
            </div>
            <!--  -->
            <div
              class="news-list clear"
              id="main-news"
              style="min-height: 1000px"
            ></div>
          </div>
        </div>
        <div class="sidebar right" id="right-side-bar" data-a="${isBaiDuAd}">
          <div class="search-right" id="search" data-spm="search-box"></div>

          <div class="godA" id="nav_button" data-spm="ad-right-sponsor"></div>
          <div
            class="godR"
            id="god_1"
            data-spm="ad-sq1"
            style="display: block"
          ></div>
          <div
            id="god_1_2"
            style="padding: 10px 20px; display: none"
            data-spm="ad-sq1"
          ></div>

          <div data-role="hot-pic" class="clearfix bord hot-atlas"></div>
          <div data-role="four-pic" class="clearfix hot-atlas"></div>

          <div
            class="godR"
            id="god_2"
            data-spm="ad-sq2"
            style="display: block"
          ></div>
          <div
            id="god_2_2"
            style="padding: 10px 20px; display: none"
            data-spm="ad-sq2"
          ></div>

          <div
            class="hot-article clear bord"
            id="hot-news-container"
            data-spm="tw"
          >
            <div id="hot-news"></div>
          </div>
          <div
            class="godR"
            id="god_3"
            data-spm="ad-sq3"
            style="display: block"
          ></div>
          <div
            id="god_3_2"
            style="padding: 10px 20px; display: none"
            data-spm="ad-sq3"
          ></div>

          <div
            class="bord clear recommend"
            id="recommend-writer"
            data-spm="mp"
          ></div>
          <div
            class="godR"
            id="god_4"
            data-spm="ad-sq4"
            style="display: block"
          ></div>
          <div
            id="god_4_2"
            style="padding: 10px 20px; display: none"
            data-spm="ad-sq4"
          ></div>

          <div id="god_5" style="padding: 10px 20px" data-spm="sqfive-ad"></div>
          <div id="god_fix_container" class="right-fixed" style="display: none">
            <div
              class="godR"
              id="god_fix_1"
              data-spm="ad-sq6"
              style="display: block"
            ></div>
            <div
              id="god_6_2"
              class="god-ad-fix"
              style="display: none; overflow: hidden"
              data-spm="ad-sq6"
            ></div>
          </div>
          <div id="fixed-view" data-rel="#hot-news" style="z-index: 2"></div>
        </div>
      </div>
      <div id="float-btn" class="float-links"></div>
      <div class="sohu-khd" data-role="wp-ad">
        <a href="javascript:void(0)" class="close-khd"></a
        ><a
          href="https://www.microsoft.com/zh-cn/store/p/%E6%90%9C%E7%8B%90uwp/9nb9229mmbjh"
          target="_blank"
          class="download-khd"
          ><i class="icon khd-d-icon"></i>免费获取</a
        >
      </div>
      <div
        class="left-bottom-float-fullScreenSleepContainer"
        style="display: none"
      >
        <div
          class="left-bottom-float-fullScreenSleep"
          style="display: none"
          data-spm="ad-fullScreenSleep"
        >
          <div class="close-tag"></div>
        </div>
      </div>
      <div
        class="left-bottom-float"
        id="left-bottom-god"
        data-spm="ad-ss"
      ></div>
    </div>
    <script type="text/javascript">
      window.deployEnv = "prod";
    </script>
    <script src="//js.sohu.com/pv.js"></script>
    <script src="//statics.itc.cn/msfe/other/initsuv.js"></script>
    <script src="//statics.itc.cn/spm/prod/js/1.0.2/index.js"></script>
    <!-- 在里插入js -->

    <script
      type="text/javascript"
      src="https://g1.itc.cn/msfe-pcarti-prod/300000000000/assets/js/vendors-5606d5.js"
    ></script>

    <script
      type="text/javascript"
      src="https://g1.itc.cn/msfe-pcarti-prod/300000000000/assets/js/libs-804f1e.js"
    ></script>

    <script
      type="text/javascript"
      src="https://g1.itc.cn/msfe-pcarti-prod/300000000000/assets/js/default.main.main_article-a0893f.js"
    ></script>

    <script
      type="text/javascript"
      src="https://g1.itc.cn/msfe-pcarti-prod/300000000000/assets/js/main_article-97ba00.js"
    ></script>

    <script>
      try {
        console.log("执行成功");
        window.sohu_mp.article({
          channel_id: "30",
          news_id: "465586308",
          cms_id: "$mpNews.cmsId",
          media_id: "464029",
          passport: "phpdevs@sohu.com",
          weboUrl: "https://mp.sohu.com/profile?xpt=cGhwZGV2c0Bzb2h1LmNvbQ==",
          title: "0.1 + 0.2 ≠ 0.3？以前我也不信",
          channel_url: "//it.sohu.com",
          categoryId: "911",
          //abData_fd用于abtest
          abData: "",
          // abData_discuss:"4", // 讨论
          abData_discuss: "", // 讨论
          abData_fd: "",
          abData_tw: "",
          originalId: "0",
          originalStatus: "0",
          isBaiDuAd: "",
          isPure: "${pure}",
          reprint: false,
          reprintSign: "",
          secureScore: "100",
          sGrade: "0",
          editor: "",
          hideAd: "",
          mpNewsExt: {
            modelId: "",
          },
        });
      } catch (e) {
        var html =
          '<div class="err-js">' +
          '<span><em class="icon err-js-icon"></em>JS加载错误，请重新加载。</span>' +
          '<a href="javascript:window.location.reload()" target="_blank" class="cached-btn"' +
          '><em class="icon-cached"></em>刷新</a></div>';
        $(document.body).prepend(html);
        console.error("发生错误", e);
      }
    </script>
  </body>
</html>
